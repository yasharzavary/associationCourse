{% extends 'base.html' %} {% load static humanize %} {% block title %} جزئیات
دوره: {{ course.title }} {%endblock title %} {% block content %}

<link rel="stylesheet" href="{% static 'css/course_detail.css' %}" />
<div class="detail-grid">
  <div class="main-content">
    <h1>{{ course.title }}</h1>

    <p><strong>چرا این دوره مهم است؟</strong></p>
    <p>
      {{ course.description|default:"توضیحات مربوط به اهمیت و محتوای این دوره به زودی در این بخش قرار خواهد گرفت." }}
    </p>

    <hr style="border-color: #e8eef3; margin: 30px 0" />

    <h3>درباره مدرس</h3>
    {% if course.instructor and course.instructor != "unk" %}
    <p><strong>نام مدرس:</strong> {{ course.instructor }}</p>
    <ul>
      {% for item in course.resume %}
      <li>{{ item }}</li>
      {% endfor %}
    </ul>
    {% else %}
    <p>اطلاعات مدرس به زودی تکمیل خواهد شد.</p>
    {% endif %}

    <hr style="border-color: #e8eef3; margin: 30px 0" />

    <h3>سرفصل‌های دوره</h3>
    <ul>
      {% for session in course.sessions_detail %}
      <li><strong>جلسه {{ forloop.counter }}:</strong> {{ session }}</li>
      {% empty %}
      <li>سرفصل‌ها به زودی اعلام می‌شود.</li>
      {% endfor %}
    </ul>
  </div>

  <aside class="sidebar">
    <div class="sidebar-widget">
      <img
        src="{{ files }}media/pictures/course_pictures/{{ course.course_picture }}"
        alt="پوستر دوره"
        style="width: 100%; border-radius: 8px"
      />
      <a
        href="{% url 'sign' course.id %}"
        class="btn signup-btn"
        style="width: 100%; margin-top: 20px; box-sizing: border-box"
        >ثبت‌نام در این دوره</a
      >
    </div>
    <div class="sidebar-widget">
      <h3>اطلاعات کلیدی دوره</h3>
      <ul>
        <li class="price-item" data-price="{{ course.price }}">
          <span>قیمت دوره:</span>
          <strong>{{ course.price }} تومان</strong>
        </li>
        <li>
          <span>تعداد جلسات:</span>
          <strong>{{ course.class_number|default:"نامشخص" }} جلسه</strong>
        </li>
        <li>
          <span>شروع:</span>
          <strong>{{ course.start_date|default:"نامشخص" }}</strong>
        </li>
        <li>
          <span>پایان:</span>
          <strong>{{ course.end_date|default:"نامشخص" }}</strong>
        </li>
      </ul>
    </div>
    <a
      href="{% url 'index' %}"
      class="btn secondary-btn"
      style="width: 100%; box-sizing: border-box"
      >بازگشت به لیست دوره‌ها</a
    >
  </aside>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    function toPersianDigits(numStr) {
      if (!numStr) return "";
      const persianDigits = "۰۱۲۳۴۵۶۷۸۹";
      return String(numStr).replace(/\d/g, (d) => persianDigits[d]);
    }

    // پردازش قیمت با استفاده از همان منطق موفق صفحه اصلی
    document.querySelectorAll(".price-item").forEach((el) => {
      const priceValue = el.getAttribute("data-price").trim();
      const strongTag = el.querySelector("strong");

      if (priceValue && !isNaN(parseInt(priceValue))) {
        const num = parseInt(priceValue);
        strongTag.textContent = `${toPersianDigits(
          num.toLocaleString("fa-IR")
        )} تومان`;
      } else {
        strongTag.textContent = "رایگان";
        strongTag.style.color = "#27ae60";
      }
    });
  });
</script>

{% endblock content %}
